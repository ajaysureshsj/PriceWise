<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard</title>
    <link rel="icon" href="./images/favicon.ico" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="./CSS/styles.css" />
  </head>
  <body>
    <!-- NAVBAR START -->
    <div class="container">
      <header
        class="d-flex flex-wrap align-items-center justify-content-center justify-content-md-between py-3 mb-4 border-bottom"
      >
        <div class="col-md-3 mb-2 mb-md-0 logo-and-name">
          <a
            href="/"
            class="d-inline-flex link-body-emphasis text-decoration-none"
          >
            <img
              src="/images/logo.png"
              alt="Price Wise Logo"
              class="header-logo"
            />
          </a>
          <h3 id="navbar-brand-name">Dashboard</h3>
        </div>

        <ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0">
          <li><a href="#track-new" class="nav-link px-2">Track New</a></li>
          <li>
            <a href="#your-cart" class="nav-link px-2">Your Cart</a>
          </li>
          <li>
            <a href="#" class="nav-link px-2">Settings</a>
          </li>
        </ul>

        <div class="d-flex">
          <div class="d-flex col-md-3 align-items-center">
            <img
              src="/images/person-circle.svg"
              alt="Profile Pic"
              width="34px"
              height="34px"
            />
            <p class="px-2 username-dashboard"><%= username %></p>
            <a href="/logout">
              <button
                type="button"
                class="btn btn-dark cta-btn-nav-primary logout-btn"
              >
                Logout
              </button>
            </a>
          </div>
        </div>
        
      </header>
    </div>
    <!-- NAVBAR END -->

    <!-- TRACK NEW PRODUCT START -->
    <section id="track-new">
    <div class="container mt-4">
      <h2>ðŸš€ Track New</h2>
      <form action="/track" method="POST">
        <div class="form-group">
          <label for="product-url">Product URL</label>
          <input
            type="text"
            class="form-control"
            id="product-url"
            name="productUrl"
            placeholder="https://www.amazon.com/dp/B08P5CBBJR/"
            required
          />
          <small class="form-text text-muted"
            >Paste the URL of the product from Amazon.</small
          >
        </div>

        <div class="form-group">
          <label for="target-price">Target Price</label>
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text">â‚¹</span>
            </div>
            <input
              type="number"
              class="form-control"
              id="target-price"
              name="targetPrice"
              step="1"
              placeholder="200"
              required
            />
          </div>
          <small class="form-text text-muted"
            >Enter your desired price. We'll notify you if it drops.</small
          >
        </div>

        <button type="submit" class="btn btn-dark cta-btn-nav-primary my-4">
          ðŸš€ Track Product
        </button>
      </form>
    </div>
  </section>
    <!-- TRACK NEW PRODUCT END -->
    <section id = your-cart>
    <div class="container">
      <hr />
      <h2>ðŸ›’ Your Cart</h2>
      <br />
      <div class="d-flex gap-3 flex-wrap">
        <% products.forEach(product => { %>
        <div class="card mb-3" style="max-width: 540px">
          <div class="row g-0">
            <div class="col-md-4">
              <img
                src="<%= product.imageUrl %>"
                class="img-fluid rounded-start"
                alt="Product Image"
                draggable="false"
              />
            </div>
            <div class="col-md-8">
              <div class="card-body">
                <h5 class="card-title"><%= product.title %></h5>
                <p class="card-text my-1">
                  Price: â‚¹<%= product.currentPrice %>
                </p>
                <p class="card-text my-1">
                  Targeted Price: â‚¹<%= product.targetPrice %>
                </p>
                <p class="card-text my-1">
                  Target Reached: <%= product.currentPrice <=
                  product.targetPrice ? "Yes" : "No" %>
                </p>
                <p class="card-text">
                  <small class="text-body-secondary"
                    >Last updated 3 mins ago</small
                  >
                </p>
              </div>
            </div>
          </div>
          <!-- Amazon logo placed here -->
          <img
            src="/images/amazon.png"
            alt=""
            class="amazon-logo"
          />
        </div>
        <% }); %>
      </div>
    </div>
  </section>
    <!-- TRACKED PRODUCTS START -->
    <%- include('partials/footer.ejs') %>
  </body>
</html>
